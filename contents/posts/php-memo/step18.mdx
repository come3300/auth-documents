---
title: 🚪 第17回：ログアウト機能を実装
category: php
---

# 🚪 ログアウト機能を実装しよう

このパートでは、**メモ投稿画面のログアウトボタンをクリックしたときにログイン画面へ戻る処理**を実装します。

セッション情報を破棄して、安全にログアウトできるようにしましょう。

---

## 🎯 本パートの目標物

- メモ投稿画面の右上にある「ログアウトボタン」をクリックするとログアウト
- **セッションが削除され、ログイン画面に戻る**

> 💡 ログアウト後に /memo にアクセスしても、ログイン画面にリダイレクトされるようになります。

---

## 🛠 実装の流れ

1. `memo/action/logout.php` を作成
2. ログアウト処理を実装
3. `memo/index.php` を修正して、ボタンから呼び出せるようにする
4. 動作確認

---

## 1) ファイルを作成する

`memo/action` ディレクトリに `logout.php` を新規作成します。

```
├── memo
│   ├── action
│   │   ├── add.php
│   │   ├── delete.php
│   │   ├── logout.php   ← 新規追加
│   │   ├── select.php
│   │   └── update.php
│   └── index.php
```

---

## 2) ログアウト処理を実装する

### 📄 `memo/action/logout.php`

```php
<?php
session_start();   // セッションを開始

// セッション情報を空にして破棄
$_SESSION = [];
session_destroy();

// ログイン画面にリダイレクト
header('Location: ../../login/');
exit;
```

---

## **💡 コードの説明**

### **① session_start()**

セッションを扱うために開始します。

### **② セッション情報を削除**

```php
$_SESSION = [];
session_destroy();
```

- `$_SESSION = [];`

  → セッション変数の中身を空にする

- `session_destroy();`

  → サーバー側に保存されているセッションデータを完全削除

この順番で実行することで、**完全にログアウト状態**にできます。

### **③ ログイン画面へリダイレクト**

```php
header('Location: ../../login/');
exit;
```

セッション削除後にログイン画面 (/login/) へ戻します。

---

## **3) メモ投稿画面のログアウトボタンを修正する**

既存のログアウトボタンのリンクを変更します。

### **修正前**

```html
<a href="../login/" class="btn btn-dark"><i class="fas fa-sign-out-alt"></i></a>
```

### **修正後**

```html
<a href="./action/logout.php" class="btn btn-dark"><i class="fas fa-sign-out-alt"></i></a>
```

これで、ログアウトボタンをクリックすると logout.php が実行されるようになります。

---

## **4) 動作確認をする**

### **🧭 手順**

1. http://localhost:8080/memo にアクセス（ログイン済みであること）
2. メモ投稿画面を開く
3. 右上の **ログアウトボタン（🚪アイコン）** をクリック

![ログアウトボタン](/images/documents/php-memo/step18/logout-button.png)

4. ログイン画面に戻ることを確認

![ログイン画面](/images/documents/php-memo/step18/login-screen.png)

> ✅ ログイン画面に戻った後、再び /memo にアクセスするとログイン画面にリダイレクトされます。

> セッション情報が破棄されている証拠です。

---

## **✅ まとめ**

- logout.php でセッション削除処理を実装
- メモ投稿画面からログアウト可能に
- セッション情報が完全に破棄される
