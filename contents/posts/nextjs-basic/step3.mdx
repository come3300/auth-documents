---
title: ç¬¬ï¼“å›ï¼šServer Componentsã¨Client Components ğŸ”„
category:  Next.js
---

## ç¬¬3ç« ï¼šServer Componentsã¨Client Components ğŸ”„

### ğŸ–¥ï¸ Server Componentsï¼ˆã‚µãƒ¼ãƒãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼‰

**Server Components**ã¯ã€ã‚µãƒ¼ãƒãƒ¼ä¸Šã§å®Ÿè¡Œã•ã‚Œã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã™ã€‚**ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã®å¨æˆ¿ã§æ–™ç†ã‚’ä½œã£ã¦ã€å®Œæˆã—ãŸæ–™ç†ã‚’ãŠå®¢ã•ã‚“ã«æä¾›ã™ã‚‹**ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ã€‚

#### **åŸºæœ¬çš„ãªServer Component**
```javascript
// app/products/page.tsx - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§Server Component
export default async function ProductsPage() {
  // ã‚µãƒ¼ãƒãƒ¼ä¸Šã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ã¯è¦‹ãˆãªã„ï¼‰
  const products = await db.products.findMany({
    orderBy: { createdAt: 'desc' }
  });
  
  return (
    <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
      <h1 className="col-span-full text-3xl font-bold mb-6">å•†å“ä¸€è¦§</h1>
      {products.map(product => (
        <div key={product.id} className="border rounded-lg p-4">
          <h2 className="text-xl font-semibold">{product.name}</h2>
          <p className="text-2xl font-bold text-green-600">
            Â¥{product.price.toLocaleString()}
          </p>
          <p className="text-gray-600 mt-2">{product.description}</p>
        </div>
      ))}
    </div>
  );
}
```

#### **Server Componentã§å¤–éƒ¨APIã‚’å‘¼ã¶ä¾‹**
```javascript
// app/weather/page.tsx - å¤©æ°—æƒ…å ±ã‚’è¡¨ç¤º
export default async function WeatherPage() {
  // APIã‚­ãƒ¼ã¯ã‚µãƒ¼ãƒãƒ¼ã§ã®ã¿ä½¿ç”¨ï¼ˆå®‰å…¨ï¼‰
  const apiKey = process.env.WEATHER_API_KEY;
  
  const weatherData = await fetch(
    `https://api.openweathermap.org/data/2.5/weather?q=Tokyo&appid=${apiKey}&units=metric`,
    { next: { revalidate: 3600 } } // 1æ™‚é–“ã”ã¨ã«æ›´æ–°
  ).then(res => res.json());
  
  return (
    <div className="max-w-md mx-auto bg-blue-100 rounded-lg p-6">
      <h1 className="text-2xl font-bold text-center mb-4">æ±äº¬ã®å¤©æ°—</h1>
      <div className="text-center">
        <p className="text-4xl font-bold">{Math.round(weatherData.main.temp)}Â°C</p>
        <p className="text-lg capitalize">{weatherData.weather[0].description}</p>
        <p className="text-sm text-gray-600 mt-2">
          ä½“æ„Ÿæ¸©åº¦: {Math.round(weatherData.main.feels_like)}Â°C
        </p>
      </div>
    </div>
  );
}
```

### ğŸ’» Client Componentsï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼‰

**Client Components**ã¯ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã§å®Ÿè¡Œã•ã‚Œã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã™ã€‚**ãŠå®¢ã•ã‚“ãŒè‡ªåˆ†ã§èª¿ç†ã™ã‚‹ç„¼è‚‰åº—**ã®ã‚ˆã†ãªã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã€ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªæ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ã€‚

#### **åŸºæœ¬çš„ãªClient Component**
```javascript
// components/Counter.tsx - ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
'use client'; // ã“ã®è¡Œã§Client Componentã«ãªã‚‹

import { useState } from 'react';

export default function Counter() {
  const [count, setCount] = useState(0);
  
  return (
    <div className="text-center p-6 border rounded-lg">
      <p className="text-2xl mb-4">ã‚«ã‚¦ãƒ³ãƒˆ: {count}</p>
      <div className="space-x-2">
        <button 
          onClick={() => setCount(count - 1)}
          className="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600"
        >
          âˆ’1
        </button>
        <button 
          onClick={() => setCount(0)}
          className="bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600"
        >
          ãƒªã‚»ãƒƒãƒˆ
        </button>
        <button 
          onClick={() => setCount(count + 1)}
          className="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"
        >
          +1
        </button>
      </div>
    </div>
  );
}
```

#### **å®Ÿç”¨çš„ãªClient Componentä¾‹ï¼šãŠå•ã„åˆã‚ã›ãƒ•ã‚©ãƒ¼ãƒ **
```javascript
// components/ContactForm.tsx
'use client';

import { useState } from 'react';

export default function ContactForm() {
  const [formData, setFormData] = useState({
    name: '',
    email: '',
    message: ''
  });
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [submitted, setSubmitted] = useState(false);
  
  const handleSubmit = async (e) => {
    e.preventDefault();
    setIsSubmitting(true);
    
    try {
      const response = await fetch('/api/contact', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(formData)
      });
      
      if (response.ok) {
        setSubmitted(true);
        setFormData({ name: '', email: '', message: '' });
      }
    } catch (error) {
      alert('é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚');
    } finally {
      setIsSubmitting(false);
    }
  };
  
  if (submitted) {
    return (
      <div className="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded">
        <p className="font-bold">é€ä¿¡å®Œäº†ï¼</p>
        <p>ãŠå•ã„åˆã‚ã›ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚48æ™‚é–“ä»¥å†…ã«ã”è¿”ä¿¡ã„ãŸã—ã¾ã™ã€‚</p>
      </div>
    );
  }
  
  return (
    <form onSubmit={handleSubmit} className="max-w-md mx-auto space-y-4">
      <div>
        <label htmlFor="name" className="block text-sm font-medium text-gray-700">
          ãŠåå‰
        </label>
        <input
          type="text"
          id="name"
          required
          value={formData.name}
          onChange={(e) => setFormData({...formData, name: e.target.value})}
          className="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2"
        />
      </div>
      
      <div>
        <label htmlFor="email" className="block text-sm font-medium text-gray-700">
          ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹
        </label>
        <input
          type="email"
          id="email"
          required
          value={formData.email}
          onChange={(e) => setFormData({...formData, email: e.target.value})}
          className="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2"
        />
      </div>
      
      <div>
        <label htmlFor="message" className="block text-sm font-medium text-gray-700">
          ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
        </label>
        <textarea
          id="message"
          rows={4}
          required
          value={formData.message}
          onChange={(e) => setFormData({...formData, message: e.target.value})}
          className="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2"
        />
      </div>
      
      <button
        type="submit"
        disabled={isSubmitting}
        className="w-full bg-blue-500 text-white py-2 px-4 rounded-md hover:bg-blue-600 disabled:opacity-50"
      >
        {isSubmitting ? 'é€ä¿¡ä¸­...' : 'é€ä¿¡ã™ã‚‹'}
      </button>
    </form>
  );
}
```

### ğŸ¤ Server Componentsã¨Client Componentsã®é€£æº

**Server Componentã®ä¸­ã§Client Componentã‚’ä½¿ã†ä¾‹ï¼š**
```javascript
// app/shop/page.tsx - Server Component
import ProductCard from './ProductCard'; // Client Component

export default async function ShopPage() {
  // ã‚µãƒ¼ãƒãƒ¼ã§å•†å“ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
  const products = await db.products.findMany();
  
  return (
    <div>
      <h1 className="text-3xl font-bold mb-8">ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚·ãƒ§ãƒƒãƒ—</h1>
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {products.map(product => (
          // Server Componentã‹ã‚‰Client Componentã«ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã™
          <ProductCard 
            key={product.id} 
            product={product} 
          />
        ))}
      </div>
    </div>
  );
}

// app/shop/ProductCard.tsx - Client Component
'use client';

import { useState } from 'react';

export default function ProductCard({ product }) {
  const [quantity, setQuantity] = useState(1);
  const [isAddingToCart, setIsAddingToCart] = useState(false);
  
  const addToCart = async () => {
    setIsAddingToCart(true);
    
    try {
      await fetch('/api/cart/add', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ 
          productId: product.id, 
          quantity 
        })
      });
      
      alert('ã‚«ãƒ¼ãƒˆã«è¿½åŠ ã—ã¾ã—ãŸï¼');
    } catch (error) {
      alert('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ');
    } finally {
      setIsAddingToCart(false);
    }
  };
  
  return (
    <div className="border rounded-lg p-4 shadow hover:shadow-lg transition-shadow">
      <img 
        src={product.imageUrl} 
        alt={product.name}
        className="w-full h-48 object-cover rounded mb-4"
      />
      <h3 className="text-xl font-semibold mb-2">{product.name}</h3>
      <p className="text-gray-600 mb-4">{product.description}</p>
      <p className="text-2xl font-bold text-green-600 mb-4">
        Â¥{product.price.toLocaleString()}
      </p>
      
      <div className="flex items-center space-x-4">
        <div className="flex items-center border rounded">
          <button 
            onClick={() => setQuantity(Math.max(1, quantity - 1))}
            className="px-3 py-1 hover:bg-gray-100"
          >
            âˆ’
          </button>
          <span className="px-4 py-1 border-x">{quantity}</span>
          <button 
            onClick={() => setQuantity(quantity + 1)}
            className="px-3 py-1 hover:bg-gray-100"
          >
            +
          </button>
        </div>
        
        <button 
          onClick={addToCart}
          disabled={isAddingToCart}
          className="flex-1 bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600 disabled:opacity-50"
        >
          {isAddingToCart ? 'è¿½åŠ ä¸­...' : 'ã‚«ãƒ¼ãƒˆã«è¿½åŠ '}
        </button>
      </div>
    </div>
  );
}
```

### âš–ï¸ Server vs Client Components ã®ä½¿ã„åˆ†ã‘

| Server Components ã‚’ä½¿ã†å ´é¢ | Client Components ã‚’ä½¿ã†å ´é¢ |
|---|---|
| ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹ | ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ“ä½œï¼ˆã‚¯ãƒªãƒƒã‚¯ã€å…¥åŠ›ï¼‰ |
| å¤–éƒ¨APIå‘¼ã³å‡ºã— | React Hookï¼ˆuseStateã€useEffectï¼‰ |
| æ©Ÿå¯†æƒ…å ±ã®å‡¦ç† | ãƒ–ãƒ©ã‚¦ã‚¶APIï¼ˆlocalStorageã€windowï¼‰ |
| SEOãŒé‡è¦ãªã‚³ãƒ³ãƒ†ãƒ³ãƒ„ | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ©Ÿèƒ½ |
| é™çš„ãªã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¡¨ç¤º | ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ |

---